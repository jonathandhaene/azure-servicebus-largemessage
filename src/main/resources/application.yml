# DISCLAIMER: This configuration is for illustration and educational purposes only.
# It is NOT production-ready. The author(s) accept NO responsibility for its use.

azure:
  servicebus:
    connection-string: ${AZURE_SERVICEBUS_CONNECTION_STRING}
    queue-name: ${AZURE_SERVICEBUS_QUEUE_NAME:my-queue}
    large-message-client:
      # Message size and blob settings
      message-size-threshold: 262144    # 256 KB
      always-through-blob: false
      cleanup-blob-on-delete: true
      blob-key-prefix: ""
      
      # Retry configuration
      retry-max-attempts: 3             # Maximum number of retry attempts
      retry-backoff-millis: 1000        # Initial backoff delay in milliseconds
      retry-backoff-multiplier: 2.0     # Backoff multiplier for exponential backoff
      retry-max-backoff-millis: 30000   # Maximum backoff delay cap in milliseconds
      
      # Dead Letter Queue (DLQ) configuration
      dead-letter-on-failure: true      # Whether to dead-letter messages on processing failure
      dead-letter-reason: "ProcessingFailure"  # Default dead-letter reason
      max-delivery-count: 10            # Informational only - actual enforcement is on Service Bus queue
      
      # SAS URI configuration
      sas-enabled: false                # Whether to generate SAS URIs for blob access
      sas-token-validation-time: P7D    # SAS token validity duration (ISO-8601 format, default: 7 days)
      message-property-for-blob-sas-uri: "$attachment.sas.uri"  # Message property name for SAS URI
      
      # Receive-only mode configuration
      receive-only-mode: false          # Whether to enable receive-only mode (download via SAS URI without storage credentials)
      
      # Content-type metadata
      default-content-type: "text/plain; charset=utf-8"  # Default MIME type for blob payloads
      
      # Auto-cleanup: delete blob payloads automatically on message completion (processor only)
      auto-cleanup-on-complete: false   # Ties blob deletion to message completion in the processor
      
      # Scheduled TTL cleanup (0 = disabled)
      ttl-cleanup-interval-minutes: 0   # Interval in minutes for automated expired-blob cleanup job
      blob-ttl-days: 0                  # TTL in days for blob payloads (0 = disabled)
      
      # Encryption configuration
      encryption:
        encryption-scope: ""            # Azure Storage encryption scope name (optional)
        customer-provided-key: ""       # Base64-encoded 256-bit AES key for CPK encryption (optional)
  storage:
    connection-string: ${AZURE_STORAGE_CONNECTION_STRING}
    container-name: ${AZURE_STORAGE_CONTAINER_NAME:large-messages}
